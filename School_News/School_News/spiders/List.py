from scrapy.http import Request
from School_News.items import Listtemp
from School_News.lib.loader import ListtempLoader
from School_News.lib.judge import *
from scrapy import Spider
import pymysql


class ListSpider(Spider):
    name = 'List'
    allowed_domains = ['218.5.241.16',
                       'by.cuc.edu.cn',
                       'luojia-whu.cn',
                       'shanghai.nyu.edu',
                       'shanghai_edu',
                       'web.fosu.edu.cn',
                       'web.ygxy.com',
                       'web.zhongxi.cn',
                       'aflc.com.cn',
                       'ahau.edu.cn',
                       'ahjzu.edu.cn',
                       'ahmu.edu.cn',
                       'ahnu.edu.cn',
                       'ahpu.edu.cn',
                       'ahpumec.edu.cn',
                       'ahstu.edu.cn',
                       'ahsztc.edu.cn',
                       'ahtcm.edu.cn',
                       'ahu.edu.cn',
                       'ahut.edu.cn',
                       'aqtc.edu.cn',
                       'arft.net',
                       'asnc.edu.cn',
                       'aufe.edu.cn',
                       'aust.edu.cn',
                       'axhu.cn',
                       'ayit.edu.cn',
                       'aynu.edu.cn',
                       'bac.edu.cn',
                       'bbmc.edu.cn',
                       'bbxy.edu.cn',
                       'bcsfxy.com',
                       'bcu.edu.cn',
                       'bda.edu.cn',
                       'beihua.edu.cn',
                       'besti.edu.cn',
                       'bfa.edu.cn',
                       'bfsu.edu.cn',
                       'bgu.edu.cn',
                       'bhu.edu.cn',
                       'bift.edu.cn',
                       'bigc.edu.cn',
                       'bipt.edu.cn',
                       'bistu.edu.cn',
                       'bisu.edu.cn',
                       'bit.edu.cn',
                       'bjfu.edu.cn',
                       'bjpc.edu.cn',
                       'bjut.edu.cn',
                       'bjwlxy.cn',
                       'blcu.edu.cn',
                       'bnu.edu.cn',
                       'bsnc.cn',
                       'bsu.edu.cn',
                       'bsuc.cn',
                       'btbu.edu.cn',
                       'buaa.edu.cn',
                       'bucea.edu.cn',
                       'bucm.edu.cn',
                       'buct.edu.cn',
                       'bupt.edu.cn',
                       'buu.edu.cn',
                       'bwu.edu.cn',
                       'bzmc.edu.cn',
                       'bznc.net.cn',
                       'bzu.edu.cn',
                       'caa.edu.cn',
                       'cafa.edu.cn',
                       'cafuc.edu.cn',
                       'cau.edu.cn',
                       'cauc.edu.cn',
                       'caztc.edu.cn',
                       'ccec.edu.cn',
                       'ccit.edu.cn',
                       'ccmu.edu.cn',
                       'ccmusic.edu.cn',
                       'ccniit.com',
                       'ccnu.edu.cn',
                       'ccom.edu.cn',
                       'ccsu.edu.cn',
                       'ccswust.com.cn',
                       'ccu.edu.cn',
                       'ccucm.edu.cn',
                       'ccufe.com',
                       'ccughc.net',
                       'ccut.edu.cn',
                       'cczu.edu.cn',
                       'cdcas.edu.cn',
                       'cdmc.edu.cn',
                       'cdnu.edu.cn',
                       'cdsu.edu.cn',
                       'cdtu.edu.cn',
                       'cdut.edu.cn',
                       'cfau.edu.cn',
                       'cfxy.cn',
                       'chd.edu.cn',
                       'chenggong.edu.cn',
                       'chtc.edu.cn',
                       'chzu.edu.cn',
                       'cicp.edu.cn',
                       'ciir.edu.cn',
                       'cjc.edu.cn',
                       'cjlu.edu.cn',
                       'cmc.edu.cn',
                       'cmu.edu.cn',
                       'cncnc.edu.cn',
                       'cnu.edu.cn',
                       'cppsu.edu.cn',
                       'cpu.edu.cn',
                       'cqjtu.edu.cn',
                       'cqmu.edu.cn',
                       'cqnu.edu.cn',
                       'cqu.edu.cn',
                       'cqucc.com.cn',
                       'cque.edu.cn',
                       'cqupt.edu.cn',
                       'cqust.edu.cn',
                       'cqut.edu.cn',
                       'cqwu.net',
                       'csiic.com',
                       'cslg.cn',
                       'csmu.edu.cn',
                       'cssf.cn',
                       'csuft.edu.cn',
                       'csust.edu.cn',
                       'ctbu.edu.cn',
                       'ctgu.edu.cn',
                       'cueb.edu.cn',
                       'cufe.edu.cn',
                       'cug.edu.cn',
                       'cugb.edu.cn',
                       'cuit.edu.cn',
                       'cumt.edu.cn',
                       'cumtb.edu.cn',
                       'cup.edu.cn',
                       'cupes.edu.cn',
                       'cupl.edu.cn',
                       'cust.edu.cn',
                       'cwu.edu.cn',
                       'cxtc.edu.cn',
                       'cymy.edu.cn',
                       'cyu.edu.cn',
                       'czc.edu.cn',
                       'czmc.com',
                       'czu.cn',
                       'czu.edu.cn',
                       'dac.edu.cn',
                       'dali.edu.cn',
                       'dfxy.net',
                       'dfzy.edu.cn',
                       'dgut.edu.cn',
                       'dhu.edu.cn',
                       'dhyedu.com',
                       'djtu.edu.cn',
                       'dlmedu.edu.cn',
                       'dlmu.edu.cn',
                       'dlnu.edu.cn',
                       'dlou.edu.cn',
                       'dlpu.edu.cn',
                       'dlu.edu.cn',
                       'dlufl.edu.cn',
                       'dlut.edu.cn',
                       'dqsy.net',
                       'dufe.edu.cn',
                       'dukekunshan.edu.cn',
                       'dzu.edu.cn',
                       'ecit.edu.cn',
                       'ecjtu.jx.cn',
                       'ecnu.edu.cn',
                       'ecupl.edu.cn',
                       'ecust.edu.cn',
                       'emcc.cn',
                       'fafu.edu.cn',
                       'fe-edu.com.cn',
                       'fimmu.com',
                       'fit.edu.cn',
                       'fjjxu.edu.cn',
                       'fjmu.edu.cn',
                       'fjnu.edu.cn',
                       'fjpsc.edu.cn',
                       'fjtcm.edu.cn',
                       'fjut.edu.cn',
                       'fudan.edu.cn',
                       'fuzhuang.com.cn',
                       'fync.edu.cn',
                       'fzfu.com',
                       'fzu.edu.cn',
                       'fzxy.edu.cn',
                       'gagx.com.cn',
                       'gdei.edu.cn',
                       'gdin.edu.cn',
                       'gdmu.edu.cn',
                       'gdou.edu.cn',
                       'gdpa.edu.cn',
                       'gdppla.edu.cn',
                       'gdpu.edu.cn',
                       'gdst.cc',
                       'gduf.edu.cn',
                       'gdufe.edu.cn',
                       'gdufs.edu.cn',
                       'gdut.edu.cn',
                       'gench.com.cn',
                       'gipe.edu.cn',
                       'git.edu.cn',
                       'glcat.edu.cn',
                       'gliet.edu.cn',
                       'glit.edu.cn',
                       'glmc.edu.cn',
                       'glut.edu.cn',
                       'gmc.edu.cn',
                       'gmu.cn',
                       'gnnu.cn',
                       'gnun.edu.cn',
                       'gsau.edu.cn',
                       'gsli.edu.cn',
                       'gsut.edu.cn',
                       'gsxy.cn',
                       'gszy.edu.cn',
                       'gucas.ac.cn',
                       'gues.edu.cn',
                       'gxlztc.net',
                       'gxmu.edu.cn',
                       'gxnu.edu.cn',
                       'gxnun.net',
                       'gxtc.edu.cn',
                       'gxtcmu.edu.cn',
                       'gxu.edu.cn',
                       'gxufe.cn',
                       'gxufl.com',
                       'gxun.edu.cn',
                       'gxut.edu.cn',
                       'gxuwz.edu.cn',
                       'gyu.cn',
                       'gzarts.edu.cn',
                       'gzgs.org.cn',
                       'gzhmc.edu.cn',
                       'gzhu.edu.cn',
                       'gzmu.edu.cn',
                       'gznc.edu.cn',
                       'gznu.cn',
                       'gztrc.edu.cn',
                       'gzu.edu.cn',
                       'gzucm.edu.cn',
                       'hacz.edu.cn',
                       'hainu.edu.cn',
                       'haue.edu.cn',
                       'haust.edu.cn',
                       'haut.edu.cn',
                       'hbafa.com',
                       'hbcf.edu.cn',
                       'hbcnc.edu.cn',
                       'hbeu.cn',
                       'hbfsh.com',
                       'hbgz.edu.cn',
                       'hbkjxy.cn',
                       'hbmu.edu.cn',
                       'hbmy.edu.cn',
                       'hbnu.edu.cn',
                       'hbpa.edu.cn',
                       'hbtcm.edu.cn',
                       'hbu.edu.cn',
                       'hbue.edu.cn',
                       'hbun.net',
                       'hbut.edu.cn',
                       'hbwy.com.cn',
                       'hcnu.edu.cn',
                       'hdc.edu.cn',
                       'hdu.edu.cn',
                       'he-edu.com',
                       'hebau.edu.cn',
                       'hebeinu.edu.cn',
                       'hebeu.edu.cn',
                       'hebiace.edu.cn',
                       'hebic.cn',
                       'hebmu.edu.cn',
                       'hebtcm.edu.cn',
                       'hebtu.edu.cn',
                       'hebust.edu.cn',
                       'hebut.edu.cn',
                       'henannu.edu.cn',
                       'henau.edu.cn',
                       'henu.edu.cn',
                       'hepec.edu.cn',
                       'hetaodaxue.com',
                       'heuet.edu.cn',
                       'hevttc.edu.cn',
                       'hezeu.edu.cn',
                       'hftc.edu.cn',
                       'hfu.edu.cn',
                       'hfut.edu.cn',
                       'hfuu.edu.cn',
                       'hgnc.net',
                       'hgs-edu.cn',
                       'hhhxy.cn',
                       'hhit.edu.cn',
                       'hhstu.edu.cn',
                       'hhu.edu.cn',
                       'hifa.edu.cn',
                       'hip.edu.cn',
                       'hist.edu.cn',
                       'hit.edu.cn',
                       'hiu.edu.cn',
                       'hkc.edu.cn',
                       'hlau.cn',
                       'hlbrc.cn',
                       'hljit.edu.cn',
                       'hlju.edu.cn',
                       'hljucm.net',
                       'hncj.edu.cn',
                       'hnctcm.edu.cn',
                       'hncu.net',
                       'hnfnu.edu.cn',
                       'hnhyedu.net',
                       'hnie.edu.cn',
                       'hnisc.com',
                       'hnist.cn',
                       'hnjtgc.com',
                       'hnmu.com.cn',
                       'hnnd.com.cn',
                       'hnnu.edu.cn',
                       'hnp.edu.cn',
                       'hnpolice.com',
                       'hnpu.edu.cn',
                       'hnsyu.net',
                       'hnu.edu.cn',
                       'hnuahe.edu.cn',
                       'hnuc.edu.cn',
                       'hnust.edu.cn',
                       'hpu.edu.cn',
                       'hqu.edu.cn',
                       'hqwy.com',
                       'hrbcu.edu.cn',
                       'hrbeu.edu.cn',
                       'hrbhuade.net',
                       'hrbipe.edu.cn',
                       'hrbmu.edu.cn',
                       'hrbnu.edu.cn',
                       'hrbu.edu.cn',
                       'hrbust.edu.cn',
                       'hrxy.edu.cn',
                       'hsit.edu.cn',
                       'hsnc.edu.cn',
                       'hstc.edu.cn',
                       'hsu.edu.cn',
                       'huanghaicollege.com',
                       'huanghuai.edu.cn',
                       'huas.cn',
                       'huat.edu.cn',
                       'hubu.edu.cn',
                       'hue.edu.cn',
                       'huel.edu.cn',
                       'huhst.edu.cn',
                       'hunaneu.com',
                       'hunau.edu.cn',
                       'hunnu.edu.cn',
                       'huse.edu.cn',
                       'hust.edu.cn',
                       'hustwb.edu.cn',
                       'hut.edu.cn',
                       'hutc.zj.cn',
                       'hxci.com.cn',
                       'hxu.edu.cn',
                       'hxxy.edu.cn',
                       'hyit.edu.cn',
                       'hynu.edu.cn',
                       'hytc.edu.cn',
                       'hzau.edu.cn',
                       'hzic.edu.cn',
                       'hzm.edu.cn',
                       'hznu.edu.cn',
                       'hzu.edu.cn',
                       'hzu.gx.cn',
                       'ieidjtu.edu.cn',
                       'imau.edu.cn',
                       'immc.edu.cn',
                       'imnc.edu.cn',
                       'imnu.edu.cn',
                       'imu.edu.cn',
                       'imufe.edu.cn',
                       'imun.edu.cn',
                       'imuoc.cn',
                       'imust.cn',
                       'imut.edu.cn',
                       'jcc.jx.cn',
                       'jci.edu.cn',
                       'jgsu.edu.cn',
                       'jhun.edu.cn',
                       'jiangnan.edu.cn',
                       'jit.edu.cn',
                       'jju.edu.cn',
                       'jladi.com',
                       'jlart.edu.cn',
                       'jlau.edu.cn',
                       'jlaudev.com.cn',
                       'jlbtc.edu.cn',
                       'jldh.com.cn',
                       'jliae.edu.cn',
                       'jlict.edu.cn',
                       'jljcxy.com',
                       'jlmu.cn',
                       'jlnku.com',
                       'jlnu.edu.cn',
                       'jlsu.edu.cn',
                       'jltiet.net',
                       'jlu.edu.cn',
                       'jlufe.edu.cn',
                       'jmsu.org',
                       'jmu.edu.cn',
                       'jnmc.edu.cn',
                       'jntc.nm.cn',
                       'jnu.edu.cn',
                       'jnxy.edu.cn',
                       'jqu.net.cn',
                       'jsie.edu.cn',
                       'jsnu.edu.cn',
                       'jspi.cn',
                       'jstu.edu.cn',
                       'jsu.edu.cn',
                       'just.edu.cn',
                       'jxau.edu.cn',
                       'jxbsu.com',
                       'jxcsedu.com',
                       'jxga.com',
                       'jxie.edu.cn',
                       'jxnu.edu.cn',
                       'jxstnu.cn',
                       'jxufe.edu.cn',
                       'jxust.cn',
                       'jxutcm.edu.cn',
                       'jyu.edu.cn',
                       'kingbridge.net',
                       'kmmc.cn',
                       'kmu.edu.cn',
                       'kmust.edu.cn',
                       'lcnc.edu.cn',
                       'lcu.edu.cn',
                       'ldxy.cn',
                       'ldxy.edu.cn',
                       'lfsfxy.edu.cn',
                       'lingnan.edu.cn',
                       'lise.edu.cn',
                       'lit.edu.cn',
                       'llhc.edu.cn',
                       'lncmxy.com',
                       'lncu.cn',
                       'lnist.edu.cn',
                       'lnit.edu.cn',
                       'lnmu.edu.cn',
                       'lnnu.edu.cn',
                       'lnpc.cn',
                       'lnpu.edu.cn',
                       'lntu.edu.cn',
                       'lnu.edu.cn',
                       'lnutcm.edu.cn',
                       'lpssy.edu.cn',
                       'lsu.edu.cn',
                       'luibe.edu.cn',
                       'lumei.edu.cn',
                       'lynu.cn',
                       'lyu.edu.cn',
                       'lyun.edu.cn',
                       'lzcc.edu.cn',
                       'lzcu.edu.cn',
                       'lzjtu.edu.cn',
                       'lzptc.edu.cn',
                       'lzu.edu.cn',
                       'mdjmu.cn',
                       'mdjnu.com',
                       'mnu.cn',
                       'mnust.cn',
                       'muc.edu.cn',
                       'nacta.edu.cn',
                       'nankai.edu.cn',
                       'nau.edu.cn',
                       'nbu.edu.cn',
                       'nbut.cn',
                       'ncbuct.com',
                       'ncepu.edu.cn',
                       'ncgxy.com',
                       'nchu.edu.cn',
                       'nciae.edu.cn',
                       'ncist.edu.cn',
                       'nclg.com.cn',
                       'ncst.edu.cn',
                       'ncu.edu.cn',
                       'ncut.edu.cn',
                       'ncwu.edu.cn',
                       'ndsy.cn',
                       'neau.cn',
                       'nedu.edu.cn',
                       'nefu.edu.cn',
                       'nenu.edu.cn',
                       'nepu.edu.cn',
                       'neu.edu.cn',
                       'neusoft.edu.cn',
                       'nfpc.edu.cn',
                       'nipes.cn',
                       'nit.edu.cn',
                       'njarti.edu.cn',
                       'njfu.edu.cn',
                       'njit.edu.cn',
                       'njmu.edu.cn',
                       'njnu.edu.cn',
                       'njtc.edu.cn',
                       'njtech.edu.cn',
                       'njtu.edu.cn',
                       'njty.edu.cn',
                       'nju.edu.cn',
                       'njue.edu.cn',
                       'njupt.edu.cn',
                       'njust.edu.cn',
                       'njutcm.edu.cn',
                       'nnxy.cn',
                       'nottingham.edu.cn',
                       'npuc.edu.cn',
                       'ntu.edu.cn',
                       'nuaa.edu.cn',
                       'nuc.edu.cn',
                       'nuist.edu.cn',
                       'nwnu.edu.cn',
                       'nwpu.edu.cn',
                       'nwsni.edu.cn',
                       'nwu.edu.cn',
                       'nxist.com',
                       'nxmu.edu.cn',
                       'nxtu.cn',
                       'nxu.edu.cn',
                       'nyist.net',
                       'nynu.edu.cn',
                       'ouc.edu.cn',
                       'pdsu.edu.cn',
                       'peihua.cn',
                       'peizheng.com.cn',
                       'peuni.cn',
                       'pku.edu.cn',
                       'plmc.edu.cn',
                       'ptu.edu.cn',
                       'pumc.edu.cn',
                       'pxc.jx.cn',
                       'qau.edu.cn',
                       'qdbhu.edu.cn',
                       'qdu.edu.cn',
                       'qfnu.edu.cn',
                       'qhmu.edu.cn',
                       'qhnu.edu.cn',
                       'qhu.edu.cn',
                       'qlnu.edu.cn',
                       'qqhrmu.cn',
                       'qqhru.edu.cn',
                       'qtech.edu.cn',
                       'qust.edu.cn',
                       'qzhu.edu.cn',
                       'qziedu.cn',
                       'qztc.edu.cn',
                       'qzu.zj.cn',
                       'rpc.edu.cn',
                       'ruc.edu.cn',
                       'sandau.edu.cn',
                       'sanlian.net.cn',
                       'sanyau.edu.cn',
                       'sasu.edu.cn',
                       'sau.edu.cn',
                       'sbs.edu.cn',
                       'scau.edu.cn',
                       'sccm.cn',
                       'scfai.edu.cn',
                       'scftvc.com',
                       'scimvc.cn',
                       'scmc.edu.cn',
                       'scpolicec.edu.cn',
                       'sctu.edu.cn',
                       'scu.edu.cn',
                       'scuec.edu.cn',
                       'scun.edu.cn',
                       'scut.edu.cn',
                       'sdada.edu.cn',
                       'sdaeu.edu.cn',
                       'sdca.edu.cn',
                       'sdili.edu.cn',
                       'sdjtu.edu.cn',
                       'sdju.edu.cn',
                       'sdjzu.edu.cn',
                       'sdkj-syu.net',
                       'sdmu.edu.cn',
                       'sdnu.edu.cn',
                       'sdpc.edu.cn',
                       'sdpei.edu.cn',
                       'sdu.edu.cn',
                       'sdupsl.edu.cn',
                       'sdust.edu.cn',
                       'sdut.edu.cn',
                       'sdutcm.edu.cn',
                       'sdwu.edu.cn',
                       'sdxiehe.com',
                       'sdyu.edu.cn',
                       'seu.edu.cn',
                       'sgit.edu.cn',
                       'sgu.edu.cn',
                       'shanghaitech.edu.cn',
                       'shcmusic.edu.cn',
                       'shengda.edu.cn',
                       'shfu.edu.cn',
                       'shiep.edu.cn',
                       'shift.edu.cn',
                       'shisu.edu.cn',
                       'shmtu.edu.cn',
                       'shnu.edu.cn',
                       'shu.edu.cn',
                       'shufe.edu.cn',
                       'shupl.edu.cn',
                       'shutcm.edu.cn',
                       'shzu.edu.cn',
                       'sicau.edu.cn',
                       'sicnu.edu.cn',
                       'sie.edu.cn',
                       'sisu.edu.cn',
                       'sit.edu.cn',
                       'siva.edu.cn',
                       'sjtu.edu.cn',
                       'sju.js.cn',
                       'sjzc.edu.cn',
                       'sjzu.edu.cn',
                       'sjzue.edu.cn',
                       'snnu.edu.cn',
                       'sqnc.edu.cn',
                       'sru.jx.cn',
                       'sspu.edu.cn',
                       'sstvc.com',
                       'sszss.com',
                       'sta.edu.cn',
                       'stbu.edu.cn',
                       'stdu.edu.cn',
                       'stu.edu.cn',
                       'suda.edu.cn',
                       'sues.edu.cn',
                       'sumhs.edu.cn',
                       'sus.edu.cn',
                       'suse.edu.cn',
                       'sust.edu.cn',
                       'sustc.edu.cn',
                       'sut.edu.cn',
                       'swfc.edu.cn',
                       'swjtu.edu.cn',
                       'swpu.edu.cn',
                       'swu.edu.cn',
                       'swun.edu.cn',
                       'swust.edu.cn',
                       'sxau.edu.cn',
                       'sxdtdx.edu.cn',
                       'sxfu.org',
                       'sxit.edu.cn',
                       'sxjztc.edu.cn',
                       'sxmtxy.net',
                       'sxmu.edu.cn',
                       'sxnu.edu.cn',
                       'sxtcm.com',
                       'sxu.edu.cn',
                       'sxufe.edu.cn',
                       'sxxh.org',
                       'syau.edu.cn',
                       'sycm.com.cn',
                       'sylu.edu.cn',
                       'symc.edu.cn',
                       'synu.edu.cn',
                       'syphu.edu.cn',
                       'sysu.edu.cn',
                       'syty.edu.cn',
                       'syu.edu.cn',
                       'syuct.edu.cn',
                       'syuctky.edu.cn',
                       'syucu.cn',
                       'syyyy.com.cn',
                       'szu.edu.cn',
                       'taru.edu.cn',
                       'thnu.edu.cn',
                       'thxy.org',
                       'tianshi.edu.cn',
                       'tijmu.edu.cn',
                       'tit.edu.cn',
                       'tjac.edu.cn',
                       'tjarts.edu.cn',
                       'tjcm.edu.cn',
                       'tjcu.edu.cn',
                       'tjfsu.edu.cn',
                       'tjipe.edu.cn',
                       'tjnu.edu.cn',
                       'tjpu.edu.cn',
                       'tju.edu.cn',
                       'tjuci.edu.cn',
                       'tjufe.edu.cn',
                       'tjut.edu.cn',
                       'tjutcm.edu.cn',
                       'tlc.edu.cn',
                       'tongji.edu.cn',
                       'tsc.edu.cn',
                       'tsinghua.edu.cn',
                       'tsmc.edu.cn',
                       'tsnu.edu.cn',
                       'tstc.edu.cn',
                       'tsu.edu.cn',
                       'tust.edu.cn',
                       'tute.edu.cn',
                       'tynu.edu.cn',
                       'tyust.edu.cn',
                       'tyut.edu.cn',
                       'tzc.edu.cn',
                       'tzsz.net',
                       'uestc.edu.cn',
                       'uibe.edu.cn',
                       'uir.cn',
                       'ujn.edu.cn',
                       'ujs.edu.cn',
                       'uoh.edu.cn',
                       'upc.edu.cn',
                       'usc.edu.cn',
                       'usst.edu.cn',
                       'ustb.edu.cn',
                       'ustc.edu.cn',
                       'usth.edu.cn',
                       'ustl.edu.cn',
                       'usx.edu.cn',
                       'utibet.edu.cn',
                       'uxd.com.cn',
                       'uzz.edu.cn',
                       'wanfang.edu.cn',
                       'wdu.edu.cn',
                       'wendaedu.com.cn',
                       'wfkjxy.com.cn',
                       'wfu.edu.cn',
                       'whcm.edu.cn',
                       'whcsc.edu.cn',
                       'whmc.edu.cn',
                       'whpu.edu.cn',
                       'whsw.net',
                       'whu.edu.cn',
                       'whut.edu.cn',
                       'wipe.edu.cn',
                       'wit.edu.cn',
                       'wjxy.edu.cn',
                       'wku.edu.cn',
                       'wnmc.edu.cn',
                       'wsu.edu.cn',
                       'wtu.edu.cn',
                       'wuhues.com',
                       'wuit.cn',
                       'wust.edu.cn',
                       'wut.edu.cn',
                       'wuyiu.edu.cn',
                       'wxc.edu.cn',
                       'wyu.edu.cn',
                       'wzmc.net',
                       'wzu.edu.cn',
                       'xacom.edu.cn',
                       'xafa.edu.cn',
                       'xafy.edu.cn',
                       'xaiu.edu.cn',
                       'xasyu.cn',
                       'xaut.edu.cn',
                       'xawl.org',
                       'xbmu.edu.cn',
                       'xcu.edu.cn',
                       'xhcom.edu.cn',
                       'xidian.edu.cn',
                       'xihangzh.com',
                       'xit.edu.cn',
                       'xiyi.edu.cn',
                       'xiyou.edu.cn',
                       'xjau.edu.cn',
                       'xjgyedu.cn',
                       'xjmu.edu.cn',
                       'xjtlu.edu.cn',
                       'xjtu.edu.cn',
                       'xju.edu.cn',
                       'xjufe.edu.cn',
                       'xmu.edu.cn',
                       'xmut.edu.cn',
                       'xnu.edu.cn',
                       'xttc.edu.cn',
                       'xtu.edu.cn',
                       'xust.edu.cn',
                       'xxmu.edu.cn',
                       'xxu.edu.cn',
                       'xyc.edu.cn',
                       'xytc.edu.cn',
                       'xzmc.edu.cn',
                       'xzmy.edu.cn',
                       'xztc.edu.cn',
                       'yangtzeu.edu.cn',
                       'ybu.edu.cn',
                       'ycit.cn',
                       'yctc.edu.cn',
                       'ycu.com.cn',
                       'ycu.edu.cn',
                       'ycu.jx.cn',
                       'yeu.edu.cn',
                       'yibinu.cn',
                       'yku.edu.cn',
                       'ylu.edu.cn',
                       'ymcn.gx.cn',
                       'ynart.edu.cn',
                       'ynau.edu.cn',
                       'yngsxy.net',
                       'ynjgy.com',
                       'ynni.edu.cn',
                       'ynnu.edu.cn',
                       'ynu.edu.cn',
                       'ynufe.edu.cn',
                       'ynutcm.edu.cn',
                       'ysu.edu.cn',
                       'ytnc.edu.cn',
                       'ytu.edu.cn',
                       'yxc.cn',
                       'yxnu.net',
                       'yytc.net.cn',
                       'yznu.cn',
                       'yzu.edu.cn',
                       'zdtj.cn',
                       'zhku.edu.cn',
                       'zist.edu.cn',
                       'zjcm.edu.cn',
                       'zjei.net',
                       'zjfc.edu.cn',
                       'zjicm.edu.cn',
                       'zjjcxy.cn',
                       'zjku.edu.cn',
                       'zjnu.edu.cn',
                       'zjou.edu.cn',
                       'zjsru.cn',
                       'zjtcm.net',
                       'zjtu.edu.cn',
                       'zju.edu.cn',
                       'zjut.edu.cn',
                       'zjweu.edu.cn',
                       'zjwu.net',
                       'zjxu.edu.cn',
                       'zknu.edu.cn',
                       'zlvc.edu.cn',
                       'zqu.edu.cn',
                       'ztu.edu.cn',
                       'zuel.edu.cn',
                       'zufe.edu.cn',
                       'zust.edu.cn',
                       'zut.edu.cn',
                       'zzhxxy.com',
                       'zzia.edu.cn',
                       'zzist.net',
                       'zzjm.edu.cn',
                       'zztc.com.cn',
                       'zzu.edu.cn',
                       'zzuli.edu.cn',
                       '.shxy.net',
                       'ygxy.fzu.edu.cn',
                       'zb.hnctxy.com',
                       'xjnu.edu.cn',
                       ]
    xpaths = []
    conn = conn_database()
    cursor = conn.cursor()
    if judge_table_exist(cursor, 'listtemp'):
        cursor.execute("SELECT listUrl FROM {}".format('listtemp'))
        first = 'no'
        # first = 'yes'
    else:
        first = 'yes'

    cursor.execute("SELECT url FROM college where child=0")
    url = cursor.fetchall()
    # start_urls = [i.get('url') for i in url]
    # print(len(start_urls))
    start_urls = ['http://www.ustb.edu.cn/']

    def __init__(self):
        a = [['a', 50], ['span', 3]]
        b = [['text()', 50], ['@href', 3], ['@title', 2]]
        c = [['\"新闻\"', 195], ['\"要闻\"', 114], ['\"动态\"', 555], ['\"通知\"', 169], ['\"头条\"', 50], ['\"更多\"', 100],
             ['\"更 多\"', 70], ['\"more\"', 120], ['\"MORE\"', 20], ]
        for i in a:
            for o in b:
                for p in c:
                    xpath = '//{}[contains({},{})]'.format(i[0], o[0], p[0])
                    # xpath2='//a/img[contains(@alt,{})]/..'.format(p[0])
                    weiget = i[1] * o[1] * p[1]
                    self.xpaths.append([xpath, weiget])
        self.xpaths = sorted(self.xpaths, key=lambda d: d[1], reverse=True)

    def start_requests(self):
        for url in self.start_urls:
            request = Request(url, meta={'parent_temp': url})
            if self.first == 'no':
                request.meta['PhantomJS'] = True
                request.meta['xpath2'] = True
            yield request

    def parse(self, response):
        resl = self.firstchoose(response)
        for url_and_name in resl:
            url = url_and_name[0]
            name = url_and_name[1]
            if not name:
                name = 'null'
            eltl = ListtempLoader(item=Listtemp(), response=response)
            eltl.add_value('listUrl', url)
            eltl.add_value('list', name)
            eltl.add_value('parent', response.meta.get('parent_temp'))
            eltlitme = eltl.load_item()
            yield eltlitme

            sql = """ UPDATE college SET child = '1' WHERE url = '{}' """.format(response.meta.get('parent_temp'))
            self.cursor.execute(sql)
            self.conn.commit()

            request = Request(url, callback=self.parse, meta={'parent_temp': response.meta.get('parent_temp')},
                              dont_filter=False)
            if self.first == 'no':
                request.meta['PhantomJS'] = True
            yield request

    def firstchoose(self, response):
        resl = []
        for x in self.xpaths:
            try:
                res_list = response.xpath(x[0] + '/@href').extract()
            except:
                continue
            try:
                res_text = response.xpath(x[0] + '/text()').extract_first()
            except:
                res_text = 'null'
            if not res_text:
                res_text = 'null'
            if res_list:
                for i in res_list:
                    res = response.urljoin(i)
                    if len(res_text) < 7:
                        print('主题列表页', res, res_text)
                        res_d = [res, res_text]
                        resl.append(res_d)
        return resl
